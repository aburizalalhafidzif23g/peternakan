<ion-header>
  <ion-toolbar color="light">
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/petugas/kegiatan" text=""></ion-back-button>
    </ion-buttons>
    <ion-title>Detail Kegiatan</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>
  <ion-list lines="none" class="list-section">

    <!-- kegiatan -->
    <h2 class="section-title">Kegiatan</h2>
    <ion-item>
      <ion-icon name="calendar-outline" slot="start" class="icon-bg"></ion-icon>
      <ion-label>{{kegiatan?.jenis}}</ion-label>
    </ion-item>

    <!-- Date -->
    <ion-item>
      <ion-icon name="calendar-outline" slot="start" class="icon-bg"></ion-icon>
      <ion-label>{{kegiatan?.tanggal}}</ion-label>
    </ion-item>

    <!-- timing -->
    <ion-item>
      <ion-icon name="time-outline" slot="start" class="icon-bg"></ion-icon>
      <ion-label>{{ kegiatan?.jam_mulai }} - {{ kegiatan?.jam_selesai }}</ion-label>
    </ion-item>

    <!-- lokasi -->
    <ion-item>
      <ion-icon name="location-outline" slot="start" class="icon-bg"></ion-icon>
      <ion-label>{{ kegiatan?.lokasi }}</ion-label>
    </ion-item>

    <!-- deskripsi -->
    <h2 class="section-title">Deskripsi</h2>
    <p class="desc-text">{{ kegiatan?.deskripsi }}</p>

    <!-- petugas -->
    <h2 class="section-title">Petugas</h2>
    <ion-item>
      <ion-label>{{ kegiatan?.petugas?.nama }}</ion-label>
    </ion-item>

    <!-- status -->
    <h2 class="section-title">Status</h2>
    <ion-item>
      <ion-icon name="ellipse-outline" slot="start" class="icon-bg"></ion-icon>
      <ion-label>
        <span *ngIf="kegiatan?.status_aktual === 'terlambat'" class="badge badge-danger">
          Terlambat
        </span>
        <span *ngIf="kegiatan?.status_aktual !== 'terlambat'">
          {{ kegiatan?.status }}
        </span>
      </ion-label>
    </ion-item>

    <!-- Upload Foto Section -->
    <h2 class="section-title">Dokumentasi</h2>
    <div class="upload-section">
      <ion-button expand="block" fill="outline" color="medium" (click)="selectPhoto()">
        <ion-icon name="camera-outline" slot="start"></ion-icon>
        Upload Foto Kegiatan
      </ion-button>
      
      <!-- Preview foto yang sudah diupload -->
      <div class="photo-preview" *ngIf="uploadedPhotos && uploadedPhotos.length > 0">
        <ion-grid>
          <ion-row>
            <ion-col size="6" *ngFor="let photo of uploadedPhotos; let i = index">
              <div class="photo-item">
                <img [src]="photo.url" alt="Foto kegiatan">
                <ion-button fill="clear" size="small" color="danger" 
                            class="delete-btn" (click)="deletePhoto(i)">
                  <ion-icon name="close-circle"></ion-icon>
                </ion-button>
              </div>
            </ion-col>
          </ion-row>
        </ion-grid>
      </div>
    </div>

  </ion-list>

  <!-- button -->
  <div class="button-container"
      *ngIf="kegiatan?.status === 'sedang_berjalan'">

    <ion-button
      expand="block"
      color="success"
      (click)="selesai()"
      [disabled]="uploadedPhotos.length === 0">

      Selesaikan Kegiatan
    </ion-button>
  </div>

  <!-- Hidden file input -->
  <input
    type="file"
    #fileInput
    accept="image/*"
    style="display: none;"
    (change)="onFileSelected($event)"
    multiple>

</ion-content>

